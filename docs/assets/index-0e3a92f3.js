var b=Object.defineProperty;var v=(n,p,o)=>p in n?b(n,p,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[p]=o;var s=(n,p,o)=>(v(n,typeof p!="symbol"?p+"":p,o),o);import{P as u}from"./phaser-c68e28a0.js";import{g as e}from"./public-97fb009b.js";import{d as w,r as B,o as G,c as S,a as _,_ as x}from"./index-f50fb5fa.js";const t={audio:{die:"die",hit:"hit",point:"point",swoosh:"swoosh",wing:"wing"},scene:{width:288,height:512,gravity:600},player:{prePos:{x:60,y:300},flapSpeed:200},bg:{static:"bgDay"},startMenu:{static:"startMenu"},gameOver:{static:"gameOver"},restart:{static:"restart"},pipe:{height:320,width:52,speed:-100,gap:140,timeGap:130,top:{static:"pipeTop"},bottom:{static:"pipeBottom"}},ground:{static:"ground",animate:{moving:"groundMoving",stop:"groundStop"}},birdRed:{static:"birdRed",animate:{flap:"birdRedFlap",stop:"birdRedStop"}},nums:{widht:24,height:36,static:{num0:"num0",num1:"num1",num2:"num2",num3:"num3",num4:"num4",num5:"num5",num6:"num6",num7:"num7",num8:"num8",num9:"num9"}}},O=w({__name:"index",setup(n){const p=B();G(()=>{const{width:m,height:g}=t.scene,i=new u.Game({type:u.AUTO,parent:p.value,width:m,height:g,backgroundColor:16711680,scene:[o],physics:{default:"arcade",arcade:{gravity:{y:t.scene.gravity},debug:!1}}}),{innerWidth:a,innerHeight:r}=window;if(a<r)i.canvas.style.cssText=`width: ${a}px; height: ${r}px; margin: 0 auto`;else{let d=m/g*r;i.canvas.style.cssText=`width: ${d}px; height: ${r}px; margin: 0 auto`}});class o extends u.Scene{constructor(){super("flappyBird");s(this,"score",0);s(this,"gameOver",!1);s(this,"gameStart",!1);s(this,"bg");s(this,"ground");s(this,"startMenu");s(this,"gameOverInfo");s(this,"restart");s(this,"player");s(this,"pipesGroup");s(this,"gapsGroup");s(this,"scoreGroup");s(this,"nextPipe",0);s(this,"upButton");s(this,"soundHit");s(this,"soundDie");s(this,"soundSwoosh");s(this,"soundWing");s(this,"soundPoint")}preload(){this.load.image(t.bg.static,e("flappyBird/sprites/background-day.png")),this.load.spritesheet(t.ground.static,e("flappyBird/sprites/ground-sprite.png"),{frameWidth:336,frameHeight:112}),this.load.image(t.startMenu.static,e("flappyBird/sprites/message-initial.png")),this.load.image(t.gameOver.static,e("flappyBird/sprites/gameover.png")),this.load.image(t.restart.static,e("flappyBird/sprites/restart-button.png")),this.load.image(t.pipe.top.static,e("flappyBird/sprites/pipe-green-top.png")),this.load.image(t.pipe.bottom.static,e("flappyBird/sprites/pipe-green-bottom.png")),this.load.image(t.nums.static.num0,e("flappyBird/sprites/number0.png")),this.load.image(t.nums.static.num1,e("flappyBird/sprites/number1.png")),this.load.image(t.nums.static.num2,e("flappyBird/sprites/number2.png")),this.load.image(t.nums.static.num3,e("flappyBird/sprites/number3.png")),this.load.image(t.nums.static.num4,e("flappyBird/sprites/number4.png")),this.load.image(t.nums.static.num5,e("flappyBird/sprites/number5.png")),this.load.image(t.nums.static.num6,e("flappyBird/sprites/number6.png")),this.load.image(t.nums.static.num7,e("flappyBird/sprites/number7.png")),this.load.image(t.nums.static.num8,e("flappyBird/sprites/number8.png")),this.load.image(t.nums.static.num9,e("flappyBird/sprites/number9.png")),this.load.spritesheet(t.birdRed.static,e("flappyBird/sprites/bird-red-sprite.png"),{frameWidth:34,frameHeight:24}),this.load.audio(t.audio.die,[e("flappyBird/audio/die.ogg"),e("flappyBird/audio/die.wav")]),this.load.audio(t.audio.hit,[e("flappyBird/audio/hit.ogg"),e("flappyBird/audio/hit.wav")]),this.load.audio(t.audio.point,[e("flappyBird/audio/point.ogg"),e("flappyBird/audio/point.wav")]),this.load.audio(t.audio.swoosh,[e("flappyBird/audio/swoosh.ogg"),e("flappyBird/audio/swoosh.wav")]),this.load.audio(t.audio.wing,[e("flappyBird/audio/wing.ogg"),e("flappyBird/audio/wing.wav")]),console.log("load down")}create(){const{width:i,height:a}=t.scene;this.bg=this.add.image(0,0,t.bg.static).setOrigin(0,0).setInteractive().on("pointerdown",()=>{this.flap()}),this.ground=this.physics.add.sprite(i/2,500,t.ground.static),this.ground.setCollideWorldBounds(!0),this.ground.setDepth(10),this.anims.create({key:t.ground.animate.moving,frames:this.anims.generateFrameNumbers(t.ground.static,{start:0,end:2}),frameRate:15,repeat:-1}),this.anims.create({key:t.ground.animate.stop,frames:[{key:t.ground.static,frame:0}],frameRate:20}),this.anims.create({key:t.birdRed.animate.flap,frames:this.anims.generateFrameNumbers(t.birdRed.static,{start:0,end:2}),frameRate:10,repeat:-1}),this.anims.create({key:t.birdRed.animate.stop,frames:[{key:t.birdRed.static,frame:1}],frameRate:20}),this.pipesGroup=this.physics.add.group(),this.gapsGroup=this.physics.add.group(),this.scoreGroup=this.physics.add.staticGroup(),this.scoreGroup.setDepth(30),this.startMenu=this.add.image(i/2,a/2,t.startMenu.static),this.startMenu.setDepth(30),this.startMenu.setInteractive().on("pointerdown",()=>{this.start()}),this.startMenu.visible=!1,this.gameOverInfo=this.add.image(i/2,200,t.gameOver.static),this.gameOverInfo.visible=!1,this.restart=this.add.image(i/2,300,t.restart.static).setInteractive().on("pointerdown",()=>{this.reStart()}),this.restart.visible=!1,this.gameOverInfo.setDepth(30),this.restart.setDepth(30),this.upButton=this.input.keyboard.addKey(u.Input.Keyboard.KeyCodes.SPACE),this.soundDie=this.sound.add(t.audio.die),this.soundHit=this.sound.add(t.audio.hit),this.soundWing=this.sound.add(t.audio.wing),this.soundSwoosh=this.sound.add(t.audio.swoosh),this.soundPoint=this.sound.add(t.audio.point),this.prepareGame()}update(){!this.gameStart||this.gameOver||(this.player.angle<90&&(this.player.angle+=1),u.Input.Keyboard.JustDown(this.upButton)&&this.flap(),this.updatePipes())}start(){this.player.body.allowGravity=!0,this.gameStart=!0,this.startMenu.visible=!1}reStart(){this.physics.resume(),this.pipesGroup.clear(!0,!0),this.gapsGroup.clear(!0,!0),this.gameOver=!1,this.gameStart=!1,this.score=0,this.gameOverInfo.visible=!1,this.restart.visible=!1,this.player.destroy(),this.prepareGame()}prepareGame(){this.startMenu.visible=!0,this.ground.anims.play(t.ground.animate.moving,!0),this.player=this.physics.add.sprite(t.player.prePos.x,t.player.prePos.y,t.birdRed.static),this.player.setCollideWorldBounds(!0),this.player.anims.play(t.birdRed.animate.flap,!0),this.player.body.allowGravity=!1,this.physics.add.collider(this.player,this.ground,this.hitBird,void 0,this),this.physics.add.collider(this.player,this.pipesGroup,this.hitBird,void 0,this),this.physics.add.overlap(this.player,this.gapsGroup,this.updateScore,void 0,this),this.updateScoreBoard()}flap(){this.gameOver||(this.soundWing.play(),this.player.setVelocityY(-t.player.flapSpeed),this.player.angle=-15)}createPipe(){const{width:i}=t.scene,{width:a,height:r,gap:d,speed:h}=t.pipe,l=u.Math.Between(-r/2+40,r/2-40),y=this.pipesGroup.create(i+a/2,l,t.pipe.top.static);y.body.allowGravity=!1,y.body.setVelocityX(t.pipe.speed);const f=this.pipesGroup.create(i+a/2,l+t.pipe.height+d,t.pipe.bottom.static);f.body.allowGravity=!1,f.body.setVelocityX(h);const c=this.add.line(i+a,l+r/2,0,0,0,d,16711680).setOrigin(0,0);this.gapsGroup.add(c),c.body.allowGravity=!1,c.body.setVelocityX(t.pipe.speed),c.visible=!1}updatePipes(){this.pipesGroup.children.iterate(function(i){i&&i.x<-50&&i.destroy()}),this.gapsGroup.children.iterate(function(i){i&&i.x<-50&&i.destroy()}),this.nextPipe++,this.nextPipe%t.pipe.timeGap===0&&(this.createPipe(),this.soundSwoosh.play())}hitBird(){console.log("gameover"),this.soundHit.play(),this.soundDie.play(),this.physics.pause(),this.gameOver=!0,this.ground.anims.play(t.ground.animate.stop,!0),this.player.anims.play(t.birdRed.animate.stop,!0),this.gameOverInfo.visible=!0,this.restart.visible=!0}updateScore(i,a){a.destroy(),this.soundPoint.play(),this.score++,this.updateScoreBoard()}updateScoreBoard(){this.scoreGroup.clear(!0,!0);const i=t.nums.widht,a=this.score.toString(),r=a.length;let d=t.scene.width/2-r*i/2;for(let h=0;h<r;h++){const l=`num${a[h]}`;this.scoreGroup.create(d+i*h,30,t.nums.static[l]).setDepth(30)}}}return(m,g)=>(_(),S("div",{class:"viewCon",ref_key:"con",ref:p},null,512))}});const I=x(O,[["__scopeId","data-v-e78df140"]]);export{I as default};
