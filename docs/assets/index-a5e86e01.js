var f=Object.defineProperty;var b=(p,s,r)=>s in p?f(p,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):p[s]=r;var i=(p,s,r)=>(b(p,typeof s!="symbol"?s+"":s,r),r);import{P as d}from"./phaser-c68e28a0.js";import{d as v,r as w,o as B,c as G,a as S,_}from"./index-48ce4fe9.js";const t={audio:{die:"die",hit:"hit",point:"point",swoosh:"swoosh",wing:"wing"},scene:{width:288,height:512,gravity:600},player:{prePos:{x:60,y:300},flapSpeed:200},bg:{static:"bgDay"},startMenu:{static:"startMenu"},gameOver:{static:"gameOver"},restart:{static:"restart"},pipe:{height:320,width:52,speed:-100,gap:140,timeGap:130,top:{static:"pipeTop"},bottom:{static:"pipeBottom"}},ground:{static:"ground",animate:{moving:"groundMoving",stop:"groundStop"}},birdRed:{static:"birdRed",animate:{flap:"birdRedFlap",stop:"birdRedStop"}},nums:{widht:24,height:36,static:{num0:"num0",num1:"num1",num2:"num2",num3:"num3",num4:"num4",num5:"num5",num6:"num6",num7:"num7",num8:"num8",num9:"num9"}}},x=v({__name:"index",setup(p){const s=w();B(()=>{const m=new d.Game({type:d.AUTO,parent:s.value,width:288,height:512,backgroundColor:16711680,scene:[r],physics:{default:"arcade",arcade:{gravity:{y:t.scene.gravity},debug:!1}}}),{innerWidth:g,innerHeight:e}=window;m.canvas.style.cssText=`width: ${g}px; height: ${e}px`});class r extends d.Scene{constructor(){super("flappyBird");i(this,"score",0);i(this,"gameOver",!1);i(this,"gameStart",!1);i(this,"bg");i(this,"ground");i(this,"startMenu");i(this,"gameOverInfo");i(this,"restart");i(this,"player");i(this,"pipesGroup");i(this,"gapsGroup");i(this,"scoreGroup");i(this,"nextPipe",0);i(this,"upButton");i(this,"soundHit");i(this,"soundDie");i(this,"soundSwoosh");i(this,"soundWing");i(this,"soundPoint")}preload(){this.load.image(t.bg.static,"/flappyBird/sprites/background-day.png"),this.load.spritesheet(t.ground.static,"/flappyBird/sprites/ground-sprite.png",{frameWidth:336,frameHeight:112}),this.load.image(t.startMenu.static,"/flappyBird/sprites/message-initial.png"),this.load.image(t.gameOver.static,"/flappyBird/sprites/gameover.png"),this.load.image(t.restart.static,"/flappyBird/sprites/restart-button.png"),this.load.image(t.pipe.top.static,"/flappyBird/sprites/pipe-green-top.png"),this.load.image(t.pipe.bottom.static,"/flappyBird/sprites/pipe-green-bottom.png"),this.load.image(t.nums.static.num0,"/flappyBird/sprites/number0.png"),this.load.image(t.nums.static.num1,"/flappyBird/sprites/number1.png"),this.load.image(t.nums.static.num2,"/flappyBird/sprites/number2.png"),this.load.image(t.nums.static.num3,"/flappyBird/sprites/number3.png"),this.load.image(t.nums.static.num4,"/flappyBird/sprites/number4.png"),this.load.image(t.nums.static.num5,"/flappyBird/sprites/number5.png"),this.load.image(t.nums.static.num6,"/flappyBird/sprites/number6.png"),this.load.image(t.nums.static.num7,"/flappyBird/sprites/number7.png"),this.load.image(t.nums.static.num8,"/flappyBird/sprites/number8.png"),this.load.image(t.nums.static.num9,"/flappyBird/sprites/number9.png"),this.load.spritesheet(t.birdRed.static,"/flappyBird/sprites/bird-red-sprite.png",{frameWidth:34,frameHeight:24}),this.load.audio(t.audio.die,["/flappyBird/audio/die.ogg","/flappyBird/audio/die.wav"]),this.load.audio(t.audio.hit,["/flappyBird/audio/hit.ogg","/flappyBird/audio/hit.wav"]),this.load.audio(t.audio.point,["/flappyBird/audio/point.ogg","/flappyBird/audio/point.wav"]),this.load.audio(t.audio.swoosh,["/flappyBird/audio/swoosh.ogg","/flappyBird/audio/swoosh.wav"]),this.load.audio(t.audio.wing,["/flappyBird/audio/wing.ogg","/flappyBird/audio/wing.wav"]),console.log("load down")}create(){const{width:e,height:a}=t.scene;this.bg=this.add.image(0,0,t.bg.static).setOrigin(0,0).setInteractive().on("pointerdown",()=>{this.flap()}),this.ground=this.physics.add.sprite(e/2,500,t.ground.static),this.ground.setCollideWorldBounds(!0),this.ground.setDepth(10),this.anims.create({key:t.ground.animate.moving,frames:this.anims.generateFrameNumbers(t.ground.static,{start:0,end:2}),frameRate:15,repeat:-1}),this.anims.create({key:t.ground.animate.stop,frames:[{key:t.ground.static,frame:0}],frameRate:20}),this.anims.create({key:t.birdRed.animate.flap,frames:this.anims.generateFrameNumbers(t.birdRed.static,{start:0,end:2}),frameRate:10,repeat:-1}),this.anims.create({key:t.birdRed.animate.stop,frames:[{key:t.birdRed.static,frame:1}],frameRate:20}),this.pipesGroup=this.physics.add.group(),this.gapsGroup=this.physics.add.group(),this.scoreGroup=this.physics.add.staticGroup(),this.scoreGroup.setDepth(30),this.startMenu=this.add.image(e/2,a/2,t.startMenu.static),this.startMenu.setDepth(30),this.startMenu.setInteractive().on("pointerdown",()=>{this.start()}),this.startMenu.visible=!1,this.gameOverInfo=this.add.image(e/2,200,t.gameOver.static),this.gameOverInfo.visible=!1,this.restart=this.add.image(e/2,300,t.restart.static).setInteractive().on("pointerdown",()=>{this.reStart()}),this.restart.visible=!1,this.gameOverInfo.setDepth(30),this.restart.setDepth(30),this.upButton=this.input.keyboard.addKey(d.Input.Keyboard.KeyCodes.SPACE),this.soundDie=this.sound.add(t.audio.die),this.soundHit=this.sound.add(t.audio.hit),this.soundWing=this.sound.add(t.audio.wing),this.soundSwoosh=this.sound.add(t.audio.swoosh),this.soundPoint=this.sound.add(t.audio.point),this.prepareGame()}update(){!this.gameStart||this.gameOver||(this.player.angle<90&&(this.player.angle+=1),d.Input.Keyboard.JustDown(this.upButton)&&this.flap(),this.updatePipes())}start(){this.player.body.allowGravity=!0,this.gameStart=!0,this.startMenu.visible=!1}reStart(){this.physics.resume(),this.pipesGroup.clear(!0,!0),this.gapsGroup.clear(!0,!0),this.gameOver=!1,this.gameStart=!1,this.score=0,this.gameOverInfo.visible=!1,this.restart.visible=!1,this.player.destroy(),this.prepareGame()}prepareGame(){this.startMenu.visible=!0,this.ground.anims.play(t.ground.animate.moving,!0),this.player=this.physics.add.sprite(t.player.prePos.x,t.player.prePos.y,t.birdRed.static),this.player.setCollideWorldBounds(!0),this.player.anims.play(t.birdRed.animate.flap,!0),this.player.body.allowGravity=!1,this.physics.add.collider(this.player,this.ground,this.hitBird,void 0,this),this.physics.add.collider(this.player,this.pipesGroup,this.hitBird,void 0,this),this.physics.add.overlap(this.player,this.gapsGroup,this.updateScore,void 0,this),this.updateScoreBoard()}flap(){this.gameOver||(this.soundWing.play(),this.player.setVelocityY(-t.player.flapSpeed),this.player.angle=-15)}createPipe(){const{width:e}=t.scene,{width:a,height:o,gap:u,speed:n}=t.pipe,h=d.Math.Between(-o/2+40,o/2-40),c=this.pipesGroup.create(e+a/2,h,t.pipe.top.static);c.body.allowGravity=!1,c.body.setVelocityX(t.pipe.speed);const y=this.pipesGroup.create(e+a/2,h+t.pipe.height+u,t.pipe.bottom.static);y.body.allowGravity=!1,y.body.setVelocityX(n);const l=this.add.line(e+a,h+o/2,0,0,0,u,16711680).setOrigin(0,0);this.gapsGroup.add(l),l.body.allowGravity=!1,l.body.setVelocityX(t.pipe.speed),l.visible=!1}updatePipes(){this.pipesGroup.children.iterate(function(e){e&&e.x<-50&&e.destroy()}),this.gapsGroup.children.iterate(function(e){e&&e.x<-50&&e.destroy()}),this.nextPipe++,this.nextPipe%t.pipe.timeGap===0&&(this.createPipe(),this.soundSwoosh.play())}hitBird(){console.log("gameover"),this.soundHit.play(),this.soundDie.play(),this.physics.pause(),this.gameOver=!0,this.ground.anims.play(t.ground.animate.stop,!0),this.player.anims.play(t.birdRed.animate.stop,!0),this.gameOverInfo.visible=!0,this.restart.visible=!0}updateScore(e,a){a.destroy(),this.soundPoint.play(),this.score++,this.updateScoreBoard()}updateScoreBoard(){this.scoreGroup.clear(!0,!0);const e=t.nums.widht,a=this.score.toString(),o=a.length;let u=t.scene.width/2-o*e/2;for(let n=0;n<o;n++){const h=`num${a[n]}`;this.scoreGroup.create(u+e*n,30,t.nums.static[h]).setDepth(30)}}}return(m,g)=>(S(),G("div",{class:"viewCon",ref_key:"con",ref:s},null,512))}});const M=_(x,[["__scopeId","data-v-7c2b661b"]]);export{M as default};
